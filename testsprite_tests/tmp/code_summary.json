{
  "tech_stack": [
    "JavaScript",
    "Node.js",
    "Express.js",
    "PostgreSQL (Supabase)",
    "MongoDB (Mongoose)",
    "Redis (Upstash)",
    "Cloudflare R2",
    "JWT",
    "Zod",
    "Multer",
    "Winston"
  ],
  "features": [
    {
      "name": "Health Check API",
      "description": "Health check endpoint to verify server status and uptime",
      "files": [
        "src/routes/healthcheck/index.js",
        "src/controllers/healthcheck/healthcheck.controller.js"
      ],
      "api_doc": {
        "openapi": "3.0.0",
        "paths": {
          "/api/v1/healthcheck": {
            "get": {
              "summary": "Check API health",
              "description": "Responds with the server's status and uptime",
              "tags": ["Healthcheck"],
              "responses": {
                "200": {
                  "description": "API is healthy",
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "status": { "type": "string", "example": "OK" },
                          "uptime": { "type": "number", "example": 123.45 },
                          "timestamp": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "name": "Authentication API",
      "description": "User authentication endpoints including registration, login, password reset, email verification, and profile management",
      "files": [
        "src/routes/user/auth.routes.js",
        "src/controllers/user/auth.controller.js",
        "src/services/auth.service.js",
        "src/middleware/auth.js",
        "src/validators/auth.validators.js"
      ],
      "api_doc": {
        "openapi": "3.0.0",
        "paths": {
          "/api/v1/auth/register": {
            "post": {
              "summary": "Register new user",
              "tags": ["Authentication"],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "email": { "type": "string", "format": "email" },
                        "password": { "type": "string", "minLength": 8 },
                        "username": { "type": "string" },
                        "fullName": { "type": "string" }
                      }
                    }
                  }
                }
              },
              "responses": {
                "201": { "description": "User registered successfully" },
                "400": { "description": "Validation error" },
                "409": { "description": "User already exists" }
              }
            }
          },
          "/api/v1/auth/login": {
            "post": {
              "summary": "Login user",
              "tags": ["Authentication"],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "email": { "type": "string", "format": "email" },
                        "password": { "type": "string" }
                      },
                      "required": ["email", "password"]
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Login successful" },
                "401": { "description": "Invalid credentials" }
              }
            }
          },
          "/api/v1/auth/refresh-token": {
            "post": {
              "summary": "Refresh access token",
              "tags": ["Authentication"],
              "responses": {
                "200": { "description": "Token refreshed" },
                "401": { "description": "Invalid refresh token" }
              }
            }
          },
          "/api/v1/auth/me": {
            "get": {
              "summary": "Get current user",
              "tags": ["Authentication"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "User data" },
                "401": { "description": "Unauthorized" }
              }
            }
          },
          "/api/v1/auth/logout": {
            "post": {
              "summary": "Logout user",
              "tags": ["Authentication"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Logout successful" }
              }
            }
          },
          "/api/v1/auth/forgot-password": {
            "post": {
              "summary": "Request password reset",
              "tags": ["Authentication"],
              "responses": {
                "200": { "description": "Password reset email sent" }
              }
            }
          },
          "/api/v1/auth/reset-password": {
            "post": {
              "summary": "Reset password with token",
              "tags": ["Authentication"],
              "responses": {
                "200": { "description": "Password reset successful" }
              }
            }
          },
          "/api/v1/auth/verify-email": {
            "post": {
              "summary": "Verify email with token",
              "tags": ["Authentication"],
              "responses": {
                "200": { "description": "Email verified" }
              }
            }
          }
        }
      }
    },
    {
      "name": "Songs API",
      "description": "Song management endpoints including CRUD operations, search, favorites, streaming, and upload",
      "files": [
        "src/routes/songs/index.js",
        "src/controllers/songs/songs.controller.js",
        "src/controllers/songs/upload.controller.js",
        "src/controllers/songs/stream.controller.js",
        "src/services/audioUpload.js"
      ],
      "api_doc": {
        "openapi": "3.0.0",
        "paths": {
          "/api/v1/songs": {
            "get": {
              "summary": "Get all songs (paginated)",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "page",
                  "in": "query",
                  "schema": { "type": "integer" }
                },
                {
                  "name": "limit",
                  "in": "query",
                  "schema": { "type": "integer" }
                }
              ],
              "responses": {
                "200": { "description": "List of songs" }
              }
            }
          },
          "/api/v1/songs/search": {
            "get": {
              "summary": "Search songs",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "q",
                  "in": "query",
                  "required": true,
                  "schema": { "type": "string" }
                }
              ],
              "responses": {
                "200": { "description": "Search results" }
              }
            }
          },
          "/api/v1/songs/popular": {
            "get": {
              "summary": "Get popular/trending songs",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Popular songs" }
              }
            }
          },
          "/api/v1/songs/recently-played": {
            "get": {
              "summary": "Get user's recently played songs",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Recently played songs" }
              }
            }
          },
          "/api/v1/songs/favorites": {
            "get": {
              "summary": "Get user's favorite songs",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Favorite songs" }
              }
            }
          },
          "/api/v1/songs/:id": {
            "get": {
              "summary": "Get single song by ID",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Song details" },
                "404": { "description": "Song not found" }
              }
            },
            "delete": {
              "summary": "Delete song",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Song deleted" },
                "404": { "description": "Song not found" }
              }
            }
          },
          "/api/v1/songs/upload": {
            "post": {
              "summary": "Upload new song to R2",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "multipart/form-data": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "audio": { "type": "string", "format": "binary" },
                        "title": { "type": "string" },
                        "artist": { "type": "string" },
                        "album": { "type": "string" }
                      }
                    }
                  }
                }
              },
              "responses": {
                "201": { "description": "Song uploaded successfully" },
                "400": { "description": "Invalid file" }
              }
            }
          },
          "/api/v1/songs/:id/stream-url": {
            "get": {
              "summary": "Get presigned streaming URL",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "quality",
                  "in": "query",
                  "schema": {
                    "type": "string",
                    "enum": ["high", "medium", "low"]
                  }
                }
              ],
              "responses": {
                "200": { "description": "Streaming URL" }
              }
            }
          },
          "/api/v1/songs/:id/stream": {
            "get": {
              "summary": "Stream song directly (redirect)",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "302": { "description": "Redirect to streaming URL" }
              }
            }
          },
          "/api/v1/songs/:id/favorite": {
            "post": {
              "summary": "Toggle favorite",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Favorite toggled" }
              }
            }
          },
          "/api/v1/songs/:id/play": {
            "post": {
              "summary": "Track play",
              "tags": ["Songs"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Play tracked" }
              }
            }
          }
        }
      }
    },
    {
      "name": "Playlists API",
      "description": "Playlist management endpoints for creating, updating, deleting playlists and managing songs within playlists",
      "files": [
        "src/routes/playlists/index.js",
        "src/controllers/songs/playlist.controller.js"
      ],
      "api_doc": {
        "openapi": "3.0.0",
        "paths": {
          "/api/v1/playlists": {
            "get": {
              "summary": "Get user's playlists",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "List of playlists" }
              }
            },
            "post": {
              "summary": "Create new playlist",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "description": { "type": "string" },
                        "isPublic": { "type": "boolean" }
                      },
                      "required": ["name"]
                    }
                  }
                }
              },
              "responses": {
                "201": { "description": "Playlist created" }
              }
            }
          },
          "/api/v1/playlists/:id": {
            "get": {
              "summary": "Get single playlist by ID",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Playlist details" },
                "404": { "description": "Playlist not found" }
              }
            },
            "patch": {
              "summary": "Update playlist details",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Playlist updated" }
              }
            },
            "delete": {
              "summary": "Delete playlist",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Playlist deleted" }
              }
            }
          },
          "/api/v1/playlists/:id/songs": {
            "post": {
              "summary": "Add song to playlist",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "songId": { "type": "string" }
                      },
                      "required": ["songId"]
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Song added to playlist" }
              }
            }
          },
          "/api/v1/playlists/:id/songs/:songId": {
            "delete": {
              "summary": "Remove song from playlist",
              "tags": ["Playlists"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Song removed from playlist" }
              }
            }
          }
        }
      }
    },
    {
      "name": "Recommendations API",
      "description": "Personalized song recommendations using hybrid ML algorithms including similar songs, mood-based recommendations, and trending songs",
      "files": [
        "src/routes/recommendations/index.js",
        "src/controllers/recommendations/recommendations.controller.js",
        "src/services/recommendation.service.js"
      ],
      "api_doc": {
        "openapi": "3.0.0",
        "paths": {
          "/api/v1/recommendations": {
            "get": {
              "summary": "Get personalized recommendations for a user",
              "description": "Returns personalized song recommendations using hybrid ML algorithms",
              "tags": ["Recommendations"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "List of recommended songs" }
              }
            }
          },
          "/api/v1/recommendations/similar/:songId": {
            "get": {
              "summary": "Get similar songs to a specific song",
              "tags": ["Recommendations"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Similar songs" }
              }
            }
          },
          "/api/v1/recommendations/mood/:mood": {
            "get": {
              "summary": "Get mood-based recommendations",
              "tags": ["Recommendations"],
              "security": [{ "bearerAuth": [] }],
              "parameters": [
                {
                  "name": "mood",
                  "in": "path",
                  "required": true,
                  "schema": { "type": "string" }
                }
              ],
              "responses": {
                "200": { "description": "Mood-based recommendations" }
              }
            }
          },
          "/api/v1/recommendations/trending": {
            "get": {
              "summary": "Get trending songs",
              "tags": ["Recommendations"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Trending songs" }
              }
            }
          },
          "/api/v1/recommendations/stats": {
            "get": {
              "summary": "Get user listening stats",
              "tags": ["Recommendations"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "User statistics" }
              }
            }
          },
          "/api/v1/recommendations/top": {
            "get": {
              "summary": "Get user's top songs",
              "tags": ["Recommendations"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Top songs" }
              }
            }
          }
        }
      }
    },
    {
      "name": "Analytics API",
      "description": "Analytics endpoints for tracking listening patterns, user statistics, genre preferences, and mood preferences",
      "files": [
        "src/routes/analytics/index.js",
        "src/controllers/analytics/analytics.controller.js",
        "src/services/analytics.service.js",
        "src/jobs/analytics.jobs.js"
      ],
      "api_doc": {
        "openapi": "3.0.0",
        "paths": {
          "/api/v1/analytics/track": {
            "post": {
              "summary": "Track a listening event",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "requestBody": {
                "required": true,
                "content": {
                  "application/json": {
                    "schema": {
                      "type": "object",
                      "properties": {
                        "songId": { "type": "string" },
                        "action": {
                          "type": "string",
                          "enum": [
                            "play",
                            "skip",
                            "complete",
                            "replay",
                            "like",
                            "dislike"
                          ]
                        },
                        "timestamp": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "duration": { "type": "number" }
                      }
                    }
                  }
                }
              },
              "responses": {
                "200": { "description": "Event tracked" }
              }
            }
          },
          "/api/v1/analytics/stats": {
            "get": {
              "summary": "Get user listening statistics",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "User statistics" }
              }
            }
          },
          "/api/v1/analytics/top-songs": {
            "get": {
              "summary": "Get user's top songs",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Top songs" }
              }
            }
          },
          "/api/v1/analytics/time-patterns": {
            "get": {
              "summary": "Get user's listening time patterns",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Time patterns" }
              }
            }
          },
          "/api/v1/analytics/genre-preferences": {
            "get": {
              "summary": "Get user's genre preferences",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Genre preferences" }
              }
            }
          },
          "/api/v1/analytics/mood-preferences": {
            "get": {
              "summary": "Get user's mood preferences",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Mood preferences" }
              }
            }
          },
          "/api/v1/analytics/trending": {
            "get": {
              "summary": "Get global trending songs",
              "tags": ["Analytics"],
              "security": [{ "bearerAuth": [] }],
              "responses": {
                "200": { "description": "Trending songs" }
              }
            }
          }
        }
      }
    }
  ]
}
